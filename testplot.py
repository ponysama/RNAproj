from Bio import Phylo
from cStringIO import StringIO
import matplotlib.pyplot as plt
treefile = "C:\\Users\\zy\\workspace\\rfamPro\\rfam1\\trees\\" + "RF00362" + ".seed_tree"
treefileString="(((((49.93_AF243383.1/10225-10322_Lactococcus_lactis_subsp._lactis:0.49274,(50.45_X77508.1/2333-2408_Escherichia_coli:0.00016,(46.55_AY248839.1/1808-1884_Ensifer_adhaerens:0.00015,21.88_AY608906.1/1675-1716_Sinorhizobium_medicae:0.08805)0.940:0.18125)0.920:0.29757)0.760:0.13344,((43.42_U77945.1/1848-1919_Pseudomonas_alcaligenes:0.15003,44.38_AM489440.1/2183-2254_Escherichia_coli:0.00015)0.980:0.39061,((60.33_AF200692.2/21025-21112_Shigella_flexneri_2a:0.21462,(31.76_X72616.1/122-187_Arabidopsis_thaliana_thale_cress:0.54261,41.39_X02819.1/3326-3410_Schizosaccharomyces_pombe_fission_yeast:0.19484)0.950:0.29412)0.930:0.22480,(((58.74_AF065404.1/6444-6521_Bacillus_anthracis:0.23918,40.27_DQ347959.1/73025-73085_Solanum_lycopersicum:0.44143)0.790:0.09471,(60.66_AF074613.1/60570-60649_Escherichia_coli_O157H7:0.07560,(32.61_Y08501.2/133100-133176_Arabidopsis_thaliana_thale_cress:0.63037,49.57_Y18999.2/2881-2957_Pseudomonas_putida:0.20708)0.580:0.09002)0.910:0.24813)0.420:0.00014,((((56.49_FM992111.1/3630-3713_Bacillus_thuringiensis:0.04926,(44.90_AB022308.1/6486-6569_Bacillus_megaterium:0.12889,53.92_EF165030.1/2861-2955_Bacillus_sp._EA1:0.37211)0.570:0.00207)0.820:0.04991,61.78_DQ787115.1/750-834_Clostridium_perfringens:0.00485)0.990:0.39647,(((55.00_X07106.1/2899-2978_Spinacia_oleracea_spinach:0.07607,49.11_X86563.2/75403-75477_Zea_mays:0.07969)0.980:0.23957,(36.24_X03415.1/1030-1100_Nicotiana_tabacum_common_tobacco:0.42252,(50.76_X07106.1/1306-1373_Spinacia_oleracea_spinach:0.07774,(51.58_X05422.1/3488-3558_Zea_mays:0.21219,48.82_AJ316582.1/78387-78450_Atropa_belladonna_belladonna:0.10381)0.650:0.12608)0.800:0.07389)0.840:0.08528)0.830:0.09310,((54.75_Z00044.2/23109-23180_Nicotiana_tabacum_common_tobacco:0.37671,44.82_Y08501.2/135699-135828_Arabidopsis_thaliana_thale_cress:0.25395)0.760:0.14343,47.00_Z00044.2/44397-44465_Nicotiana_tabacum_common_tobacco:0.30909)0.530:0.01001)0.850:0.07936)0.490:0.02589,((66.31_AJ277126.1/2879-2953_Pylaiella_littoralis:0.10923,(62.93_AJ277126.1/8230-8302_Pylaiella_littoralis:0.26586,(69.99_AJ277126.1/6413-6487_Pylaiella_littoralis:0.14765,62.78_X17375.2/29364-29438_Scenedesmus_obliquus:0.04288)0.960:0.10416)0.390:0.00676)0.890:0.04231,(70.63_AF029891.1/4522-4594_Cryphonectria_parasitica_chestnut_blight_fungus:0.05943,(70.01_X73671.1/1293-1367_Trimorphomyces_papilionaceus:0.20852,((65.44_U41288.1/3118-3192_Allomyces_macrogynus:0.09861,(66.70_M68929.1/49817-49892_Marchantia_polymorpha_liverwort:0.00015,(63.03_AJ130737.1/1761-1840_Angiopteris_palmiformis:0.05592,(61.09_AJ131145.1/1727-1802_Vandenboschia_radicans:0.00014,((57.56_AJ131144.1/1753-1833_Stegnogramma_wilfordii:0.00014,49.54_AJ130746.1/1754-1835_Diplazium_proliferum:0.01373)0.980:0.06200,(60.48_AJ131136.1/1732-1807_Marsilea_drummondii:0.00014,58.39_AJ131147.1/1719-1794_Salvinia_auriculata:0.01449)0.810:0.01449)0.680:0.01493)0.780:0.03071)0.960:0.09129)0.790:0.05484)0.850:0.02901,68.66_AF029891.1/9161-9235_Cryphonectria_parasitica_chestnut_blight_fungus:0.04597)0.620:0.00014)0.180:0.02277)0.730:0.04246)0.310:0.00015)0.880:0.24040)0.970:0.31350)0.300:0.01885)0.620:0.05149)0.620:0.06863,((43.14_M68929.1/120754-120816_Marchantia_polymorpha_liverwort:0.47398,57.32_U13767.1/4803-4881_Anabaena_sp.:0.21537)0.690:0.09844,44.46_AF314856.1/1250-1311_Catasetum_expansum:0.65039)0.570:0.00015)0.910:0.19851,((54.12_M68929.1/7762-7915_Marchantia_polymorpha_liverwort:0.37132,(63.25_Z72500.1/3161-3251_Pylaiella_littoralis:0.45068,(70.12_M36911.1/2445-2539_Podospora_anserina:0.00787,69.33_Z69899.1/2926-3021_Podospora_comata:0.05576)0.640:0.08975)0.570:0.13558)0.850:0.13217,((53.55_AF235045.1/658-731_Amborella_trichopoda:0.00014,53.08_AB042240.3/88259-88332_Triticum_aestivum_bread_wheat:0.01473)1.000:0.40611,(65.33_U41288.1/27369-27451_Allomyces_macrogynus:0.14887,(66.55_X04336.1/3210-3313_Podospora_anserina:0.04709,(40.44_X63625.1/1815-1875_Daucus_carota_carrot:0.00016,(42.41_X17395.1/1934-1994_Petunia_x_hybrida:0.02342,(41.28_X62341.1/1274-1336_Helianthus_annuus_common_sunflower:0.02203,(41.92_X01088.1/1893-1955_Oryza_sativa_rice:0.00014,35.84_V00712.1/1227-1289_Zea_mays:0.02216)0.700:0.02259)0.880:0.05058)0.120:0.02443)0.990:0.33035)0.650:0.11944)0.650:0.09228)0.710:0.00014)0.900:0.05658)0.260:0.00015,(58.64_AJ277126.1/35792-35885_Pylaiella_littoralis:0.20879,((39.95_X97295.1/1333-1451_Oenothera_lamarckiana:0.00016,(35.10_X86563.2/124799-124917_Zea_mays:0.01154,32.62_L43910.1/323-456_Triticum_aestivum_bread_wheat:0.30619)0.890:0.03622)0.920:0.41594,(42.13_V00166.1/1829-1941_Nicotiana_tabacum_common_tobacco:0.00016,(42.84_X04465.1/116403-116516_Marchantia_polymorpha_liverwort:0.16770,42.66_Z00028.1/5121-5234_Zea_mays:0.03582)0.970:0.17134)0.940:0.28183)0.950:0.33950)0.990:0.25273,((((49.52_AM087200.3/1851-1962_Solanum_lycopersicum:0.46939,((61.94_X55026.1/77786-77867_Podospora_anserina:0.11930,63.86_L36897.1/2659-2743_Saccharomyces_cerevisiae_bakers_yeast:0.27829)0.710:0.06169,(54.19_Z00044.2/12618-12705_Nicotiana_tabacum_common_tobacco:0.06969,53.77_AC145820.20/76030-76117_Cicer_arietinum_chickpea:0.05469)1.000:0.39256)0.500:0.04899)0.710:0.04904,(60.97_AJ277126.1/33096-33168_Pylaiella_littoralis:0.32451,((43.82_Y08501.2/169475-169584_Arabidopsis_thaliana_thale_cress:0.33536,(((50.23_X60045.1/1000-1142_Arabidopsis_thaliana_thale_cress:0.00015,(47.70_X72287.1/717-859_Vigna_unguiculata_subsp._cylindrica_horse_gram:0.00662,48.23_Y12731.1/1118-1260_Vicia_faba_fava_bean:0.01342)0.780:0.00667)1.000:0.00016,(44.44_AF143425.1/760-901_Cycas_panzhihuaensis:0.16764,(41.11_AF143423.1/825-965_Pseudolarix_amabilis:0.02940,(41.81_AF143421.1/868-1007_Tsuga_mertensiana:0.00507,46.84_AF143424.1/944-1083_Cedrus_atlantica:0.02267)0.990:0.09555)0.200:0.04887)1.000:0.24320)1.000:0.46422,(48.15_M68929.1/41010-41093_Marchantia_polymorpha_liverwort:0.17963,48.92_M81726.1/5191-5288_Oenothera_berteroana:0.44182)0.690:0.02813)0.190:0.00907)0.580:0.14818,47.40_AF080083.1/1551-1683_Carpinus_caroliniana_American_hornbeam:0.48882)0.820:0.12486)0.890:0.15332)0.890:0.12136,(67.82_V00694.1/5204-5294_Saccharomyces_cerevisiae_bakers_yeast:0.02285,68.25_X57546.1/2817-2907_Kluyveromyces_lactis:0.00968)0.860:0.20117)0.670:0.05749,((((63.35_AJ315331.1/53-130_Nicotiana_sylvestris_wood_tobacco:0.07267,(49.30_AJ277126.1/9249-9325_Pylaiella_littoralis:0.0,49.30_AB281599.1/897-973_Pylaiella_littoralis:0.0):0.59662)0.340:0.01726,((55.38_Z00044.2/84067-84143_Nicotiana_tabacum_common_tobacco:0.02833,(53.33_M15176.1/580-656_Zea_mays:0.04817,(50.39_AJ316582.1/9914-9993_Atropa_belladonna_belladonna:0.06852,47.76_AB027572.1/1862-1941_Triticum_aestivum_bread_wheat:0.00015)1.000:0.31657)0.430:0.05669)0.420:0.06447,60.77_X03834.1/1418-1494_Landoltia_punctata:0.02384)0.980:0.20712)0.860:0.11295,59.33_AJ316582.1/98072-98150_Atropa_belladonna_belladonna:0.38843)0.530:0.03174,(60.90_Z00044.2/45410-45483_Nicotiana_tabacum_common_tobacco:0.23901,(56.58_X71404.1/2822-2898_Calothrix_sp.:0.28465,(60.71_X86563.2/93102-93178_Zea_mays:0.01492,(56.51_X03481.1/524-600_Nicotiana_tabacum_common_tobacco:0.01200,48.41_X04465.1/8-84_Marchantia_polymorpha_liverwort:0.22302)0.770:0.03214)0.930:0.18521)0.700:0.07160)0.690:0.04035)0.920:0.22505)0.860:0.08203);"
handle = StringIO(treefileString)
tree = Phylo.read(treefile, "newick")
tree.ladderize()
Phylo.draw(tree)
plt.show();

"""import matplotlib.pyplot as plt
import numpy as np
import scipy.misc as misc 


t = np.arange(0., 1., 0.002)


plt.plot(t, misc.comb(35,26)*(t**26)*(1-t)**9)
plt.ylabel('likelihood')
plt.xlabel('parameter theta')
axes = plt.subplot(111)
xmajorLocator   = plt.MultipleLocator(0.05)
ymajorLocator   = plt.MultipleLocator(0.005)
axes.xaxis.set_major_locator(xmajorLocator) 
axes.yaxis.set_major_locator(ymajorLocator) 
plt.show()"""


